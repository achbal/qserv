# -*- python -*-
Import('env')
Import('libProducts')
Import('cacheObjs')

import os
import itertools

programs = []

# deps on other modules
modDeps = "log".split()
deps = itertools.chain(*map(lambda m: libProducts[m], modDeps))
deps = cacheObjs(env, deps, ".o")
deps = map(lambda i:i, deps) # un-chain
myDeps = filter(lambda i: not str(i).startswith("test"), env.Glob("*.cc"))
extDeps = "antlr boost_regex boost_thread-mt protobuf ssl crypto XrdPosix XrdClient XrdPosixPreload XrdUtils mysqlclient_r zookeeper_mt".split()

p = env.Program(["testCssException.cc"] + env.Object(myDeps) + deps, LIBS=extDeps)
programs.append(p)

p = env.Program(["testKvInterfaceImplMem.cc"] + env.Object(myDeps) + deps, LIBS=extDeps)
programs.append(p)

p = env.Program(["testKvInterfaceImplZoo.cc"] + env.Object(myDeps) + deps, LIBS=extDeps)
programs.append(p)

p = env.Program(["testFacade.cc"] + env.Object(myDeps) + deps, LIBS=extDeps)
programs.append(p)

Return('programs')
